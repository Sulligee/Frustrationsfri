<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FrustrationsFri - Slip dine frustrationer l√∏s sikkert</title>
    <meta name="description" content="Digital platform til sikker udladning af frustrationer. 12 scenarier, AI-dreven samtale, stemme-support. H√•ndter stress, vrede og irritation konstruktivt.">
    <meta name="keywords" content="frustration, stress, vrede, udladning, mental helbred, AI terapi, mindfulness, anger management, dansk">
    <meta name="author" content="FrustrationsFri Team">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Danish">
    <meta property="og:title" content="FrustrationsFri - Slip dine frustrationer l√∏s sikkert">
    <meta property="og:description" content="Digital platform til sikker udladning af frustrationer. 12 scenarier, AI-dreven samtale, stemme-support. H√•ndter stress, vrede og irritation konstruktivt.">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="da_DK">
    <meta name="theme-color" content="#EF4444">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="FrustrationsFri">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and dependencies -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide React Icons -->
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
    
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { Send, RotateCcw, Heart, MessageCircle, Mic, MicOff, Volume2, VolumeX } = LucideReact;

        const FrustrationApp = () => {
          const [currentScreen, setCurrentScreen] = useState('welcome');
          const [selectedScenario, setSelectedScenario] = useState(null);
          const [selectedIntensity, setSelectedIntensity] = useState('medium');
          const [messages, setMessages] = useState([]);
          const [inputMessage, setInputMessage] = useState('');
          const [isLoading, setIsLoading] = useState(false);
          const [sessionPhase, setSessionPhase] = useState('provokation');
          const [messageCount, setMessageCount] = useState(0);
          const [isListening, setIsListening] = useState(false);
          const [isSpeaking, setIsSpeaking] = useState(false);
          const [voiceEnabled, setVoiceEnabled] = useState(true);
          const [sessionHistory, setSessionHistory] = useState([]);
          const [showHistory, setShowHistory] = useState(false);
          const [sessionFeedback, setSessionFeedback] = useState(null);
          const [errors, setErrors] = useState([]);
          const messagesEndRef = useRef(null);
          const recognitionRef = useRef(null);
          const synthRef = useRef(null);

          const scenarios = [
            {
              id: 'chef',
              title: 'Min Chef',
              description: 'Den chef der aldrig lytter eller anerkender dit arbejde',
              color: 'bg-red-500',
              emoji: 'üëî',
              voice: 'male'
            },
            {
              id: 'partner',
              title: 'Min Partner',
              description: 'Frustrationer i forholdet der skal ud',
              color: 'bg-pink-500', 
              emoji: 'üíï',
              voice: 'female'
            },
            {
              id: 'ex',
              title: 'Min Ex',
              description: 'Den ex-k√¶reste der stadig irriterer dig',
              color: 'bg-purple-500',
              emoji: 'üíî',
              voice: 'female'
            },
            {
              id: 'for√¶lder',
              title: 'Mine For√¶ldre',
              description: 'For√¶ldrerelationer der kan v√¶re sv√¶re',
              color: 'bg-blue-500',
              emoji: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
              voice: 'male'
            },
            {
              id: 'b√∏rn',
              title: 'Mine B√∏rn',
              description: 'Teenager-drama og trodsige b√∏rn',
              color: 'bg-orange-500',
              emoji: 'üë∂',
              voice: 'female'
            },
            {
              id: 'kollega',
              title: 'Min Kollega',
              description: 'Arbejdsplads-drama og irriterende kollegaer',
              color: 'bg-yellow-500',
              emoji: 'üè¢',
              voice: 'female'
            },
            {
              id: 'venner',
              title: 'Mine Venner',
              description: 'Venskaber der frustrerer eller skuffer',
              color: 'bg-green-500',
              emoji: 'üë•',
              voice: 'female'
            },
            {
              id: 'naboer',
              title: 'Mine Naboer',
              description: 'St√∏jende, irriterende eller ubeh√∏vlede naboer',
              color: 'bg-teal-500',
              emoji: 'üè†',
              voice: 'male'
            },
            {
              id: 'trafik',
              title: 'Trafikanter',
              description: 'Idioter p√• vejen og d√•rlige bilister',
              color: 'bg-red-600',
              emoji: 'üöó',
              voice: 'male'
            },
            {
              id: 'kundeservice',
              title: 'Kundeservice',
              description: 'Ubrugelig support og bureaukratisk hj√¶lp',
              color: 'bg-gray-500',
              emoji: 'üìû',
              voice: 'female'
            },
            {
              id: 'politik',
              title: 'Politikere',
              description: 'Politiker-l√∏gne og samfunds-frustrationer',
              color: 'bg-indigo-500',
              emoji: 'üèõÔ∏è',
              voice: 'male'
            },
            {
              id: 'sociale_medier',
              title: 'Sociale Medier',
              description: 'Online drama, trolls og falske venner',
              color: 'bg-blue-600',
              emoji: 'üì±',
              voice: 'female'
            }
          ];

          const intensityLevels = [
            {
              id: 'mild',
              title: 'Mild',
              description: 'Lidt udfordrende, mere st√∏ttende',
              color: 'bg-green-500',
              emoji: 'üòå'
            },
            {
              id: 'medium',
              title: 'Medium',
              description: 'Balanceret mellem provokation og st√∏tte',
              color: 'bg-yellow-500',
              emoji: 'üòê'
            },
            {
              id: 'intens',
              title: 'Intens',
              description: 'Meget provokerende, hold dig fast!',
              color: 'bg-red-500',
              emoji: 'üò§'
            }
          ];

          // Load session history
          useEffect(() => {
            const savedHistory = JSON.parse(localStorage.getItem('frustration_app_history') || '[]');
            setSessionHistory(savedHistory);
          }, []);

          // Save session to history
          const saveSessionToHistory = (scenario, intensity, messageCount, feedback) => {
            const session = {
              id: Date.now(),
              scenario: scenario.title,
              scenarioEmoji: scenario.emoji,
              intensity,
              messageCount,
              feedback,
              timestamp: new Date().toISOString(),
              date: new Date().toLocaleDateString('da-DK')
            };

            const newHistory = [session, ...sessionHistory].slice(0, 20);
            setSessionHistory(newHistory);
            localStorage.setItem('frustration_app_history', JSON.stringify(newHistory));
          };

          // Initialize speech recognition
          useEffect(() => {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
              const SpeechRecognition = window.webkitSpeechRecognition || window.SpeechRecognition;
              recognitionRef.current = new SpeechRecognition();
              recognitionRef.current.continuous = false;
              recognitionRef.current.interimResults = false;
              recognitionRef.current.lang = 'da-DK';

              recognitionRef.current.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                setInputMessage(transcript);
                setIsListening(false);
              };

              recognitionRef.current.onerror = (event) => {
                console.error('Speech recognition error:', event.error);
                setIsListening(false);
                alert('Stemme-fejl: ' + event.error);
              };

              recognitionRef.current.onend = () => {
                setIsListening(false);
              };
            }

            synthRef.current = window.speechSynthesis;
            
            return () => {
              if (recognitionRef.current) {
                recognitionRef.current.stop();
              }
              if (synthRef.current) {
                synthRef.current.cancel();
              }
            };
          }, []);

          const startListening = () => {
            if (!recognitionRef.current) {
              alert('Din browser underst√∏tter ikke stemme-genkendelse. Pr√∏v Chrome eller Safari.');
              return;
            }
            
            if (!isListening) {
              setInputMessage('');
              setIsListening(true);
              
              try {
                recognitionRef.current.start();
              } catch (error) {
                console.error('Error starting recognition:', error);
                setIsListening(false);
                alert('Fejl ved start af stemme-genkendelse: ' + error.message);
              }
            }
          };

          const stopListening = () => {
            if (recognitionRef.current && isListening) {
              recognitionRef.current.stop();
              setIsListening(false);
            }
          };

          const speakMessage = (text, voice = 'female') => {
            if (!voiceEnabled || !synthRef.current) return;

            synthRef.current.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'da-DK';
            utterance.rate = 0.9;
            utterance.pitch = voice === 'female' ? 1.2 : 0.8;
            
            const voices = synthRef.current.getVoices();
            const danishVoice = voices.find(v => v.lang.includes('da')) || 
                               voices.find(v => v.lang.includes('en')) ||
                               voices[0];
            
            if (danishVoice) {
              utterance.voice = danishVoice;
            }

            utterance.onstart = () => setIsSpeaking(true);
            utterance.onend = () => setIsSpeaking(false);
            utterance.onerror = () => setIsSpeaking(false);

            synthRef.current.speak(utterance);
          };

          const toggleVoice = () => {
            setVoiceEnabled(!voiceEnabled);
            if (!voiceEnabled === false) {
              synthRef.current?.cancel();
              setIsSpeaking(false);
            }
          };

          const scrollToBottom = () => {
            messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
          };

          useEffect(() => {
            scrollToBottom();
          }, [messages]);

          // Simplified AI response (demo mode without Claude API)
          const generateAIResponse = async (userMessage, scenario, phase) => {
            // Demo responses for different phases
            const demoResponses = {
              provokation: {
                chef: ["Hvad siger du? Jeg har ikke tid.", "Det er dit problem, ikke mit.", "Arbejd h√•rdere n√¶ste gang."],
                partner: ["Hvad nu igen?", "Du dramatiserer.", "Ikke nu."],
                ex: ["Hvad vil du?", "Vi er f√¶rdige.", "Det var din egen skyld."]
              },
              refleksion: [
                "M√•ske jeg var for h√•rd. Hvordan har du det?",
                "Du har ret. Jeg burde lytte bedre.",
                "Jeg kan se du er p√•virket. Undskyld."
              ]
            };

            // Simulate loading time
            await new Promise(resolve => setTimeout(resolve, 1000));

            let response;
            if (phase === 'provokation') {
              const scenarioResponses = demoResponses.provokation[scenario.id] || demoResponses.provokation.chef;
              response = scenarioResponses[Math.floor(Math.random() * scenarioResponses.length)];
            } else {
              response = demoResponses.refleksion[Math.floor(Math.random() * demoResponses.refleksion.length)];
            }

            return {
              response,
              shouldTransition: messageCount >= 3 && phase === 'provokation'
            };
          };

          const sendMessage = async () => {
            if (!inputMessage.trim() || isLoading) return;

            const newMessage = {
              id: Date.now(),
              text: inputMessage,
              sender: 'user',
              timestamp: new Date()
            };

            setMessages(prev => [...prev, newMessage]);
            const currentInput = inputMessage;
            setInputMessage('');
            setIsLoading(true);
            setMessageCount(prev => prev + 1);

            try {
              const aiResponse = await generateAIResponse(currentInput, selectedScenario, sessionPhase);
              
              const aiMessage = {
                id: Date.now() + 1,
                text: aiResponse.response,
                sender: 'ai',
                timestamp: new Date()
              };

              setMessages(prev => [...prev, aiMessage]);

              if (voiceEnabled) {
                try {
                  speakMessage(aiResponse.response, selectedScenario.voice || 'female');
                } catch (speechError) {
                  console.error('Speech error:', speechError);
                }
              }

              // Check transition
              if ((aiResponse.shouldTransition || messageCount >= 3) && sessionPhase === 'provokation') {
                setTimeout(() => {
                  setSessionPhase('refleksion');
                  
                  const transitionMessages = {
                    chef: "Stop... Du har ret. Jeg har behandlet dig forf√¶rdeligt. Undskyld.",
                    partner: "Stop... Du har ret. Jeg lytter aldrig til dig. Undskyld.",
                    ex: "Du har ret... Jeg var et r√∏vhul. Du fortjente bedre."
                  };
                  
                  const transitionMessage = {
                    id: Date.now() + 2,
                    text: transitionMessages[selectedScenario.id] || "Du har ret... Undskyld.",
                    sender: 'ai',
                    timestamp: new Date(),
                    isTransition: true
                  };
                  setMessages(prev => [...prev, transitionMessage]);
                  
                  if (voiceEnabled) {
                    setTimeout(() => {
                      try {
                        speakMessage(transitionMessage.text, selectedScenario.voice || 'female');
                      } catch (speechError) {
                        console.error('Speech error:', speechError);
                      }
                    }, 1000);
                  }
                }, 2000);
              } else if (messageCount >= 7 && sessionPhase === 'refleksion') {
                setTimeout(() => {
                  setSessionPhase('afslutning');
                }, 1000);
              }

            } catch (error) {
              console.error('Send message error:', error);
              
              const errorMessage = {
                id: Date.now() + 1,
                text: "Beklager, der opstod en fejl. Pr√∏v venligst igen.",
                sender: 'ai',
                timestamp: new Date(),
                isError: true
              };
              
              setMessages(prev => [...prev, errorMessage]);
            } finally {
              setIsLoading(false);
            }
          };

          const startNewSession = () => {
            setCurrentScreen('scenarios');
            setMessages([]);
            setMessageCount(0);
            setSessionPhase('provokation');
            setSelectedScenario(null);
            setSelectedIntensity('medium');
            setSessionFeedback(null);
            setErrors([]);
          };

          const handleKeyPress = (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
              e.preventDefault();
              sendMessage();
            }
          };

          // Simple Find Ro Component for demo
          const FindRoComponent = () => {
            const [currentStep, setCurrentStep] = useState('welcome');
            
            if (currentStep === 'welcome') {
              return (
                <div className="bg-gradient-to-br from-green-100 via-blue-100 to-purple-100 min-h-screen p-6">
                  <div className="max-w-4xl mx-auto">
                    <div className="text-center mb-4">
                      <button
                        onClick={() => setCurrentScreen('welcome')}
                        className="text-gray-600 hover:text-gray-800 transition-colors"
                      >
                        ‚Üê Tilbage til hjem
                      </button>
                    </div>
                    
                    <div className="text-center mb-8">
                      <div className="w-20 h-20 bg-gradient-to-br from-green-400 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                        <Heart className="w-10 h-10 text-white" />
                      </div>
                      <h3 className="text-3xl font-bold text-gray-800 mb-2">Find Ro üåÖ</h3>
                      <p className="text-lg text-gray-600 mb-2">Velkommen til din ro-oase</p>
                      <p className="text-gray-500">Tag dig tid til afsp√¶nding, meditation og refleksion</p>
                    </div>

                    <div className="grid md:grid-cols-2 gap-6 mb-8">
                      <div className="bg-white rounded-xl p-6 shadow-lg">
                        <h4 className="text-xl font-semibold text-gray-800 mb-4">üßò‚Äç‚ôÄÔ∏è Afsp√¶ndings√∏velser</h4>
                        <p className="text-gray-600 mb-4">
                          Tag dig tid til at slippe sp√¶ndinger og finde ro.
                        </p>
                        <button
                          onClick={() => setCurrentStep('exercises')}
                          className="bg-gradient-to-r from-green-500 to-blue-500 text-white px-6 py-3 rounded-lg hover:from-green-600 hover:to-blue-600 transition-all duration-200 w-full font-semibold"
                        >
                          Start Afsp√¶nding
                        </button>
                      </div>

                      <div className="bg-white rounded-xl p-6 shadow-lg">
                        <h4 className="text-xl font-semibold text-gray-800 mb-4">üí≠ Refleksion</h4>
                        <p className="text-gray-600 mb-4">
                          Reflekter over din dag, dine f√∏lelser eller bare skriv dine tanker ned.
                        </p>
                        <button
                          onClick={() => alert('Refleksions-funktionen er under udvikling!')}
                          className="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-200 w-full font-semibold"
                        >
                          Start Refleksion
                        </button>
                      </div>
                    </div>

                    <div className="text-center">
                      <button
                        onClick={() => setCurrentScreen('welcome')}
                        className="bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500 text-white px-8 py-3 rounded-lg hover:shadow-lg transition-all duration-200 font-semibold"
                      >
                        Start Frustration Session
                      </button>
                    </div>
                  </div>
                </div>
              );
            }

            if (currentStep === 'exercises') {
              return (
                <div className="bg-gradient-to-br from-green-100 via-blue-100 to-purple-100 min-h-screen p-6">
                  <div className="max-w-4xl mx-auto">
                    <div className="text-center mb-8">
                      <button
                        onClick={() => setCurrentStep('welcome')}
                        className="text-gray-600 hover:text-gray-800 transition-colors mb-4"
                      >
                        ‚Üê Tilbage
                      </button>
                      <h3 className="text-3xl font-bold text-gray-800 mb-2">Afsp√¶ndings√∏velser üßò‚Äç‚ôÄÔ∏è</h3>
                      <p className="text-gray-600">Demo √∏velser (fuld version kommer snart)</p>
                    </div>

                    <div className="bg-white rounded-xl p-8 shadow-lg text-center">
                      <h4 className="text-2xl font-semibold text-gray-800 mb-4">üå¨Ô∏è Dyb Vejrtr√¶kning</h4>
                      <p className="text-gray-600 mb-6">Tag 5 dybe vejrtr√¶kninger:</p>
                      <ol className="text-left text-gray-700 space-y-2 mb-6 max-w-md mx-auto">
                        <li>1. Ind√•nd langsomt gennem n√¶sen i 4 sekunder</li>
                        <li>2. Hold vejret i 4 sekunder</li>
                        <li>3. Ud√•nd gennem munden i 6 sekunder</li>
                        <li>4. Gentag rytmen roligt</li>
                        <li>5. M√¶rk hvordan din krop slapper af</li>
                      </ol>
                      <p className="text-green-700 font-medium">üåü Tag dig tiden - der er ingen stress her</p>
                    </div>
                  </div>
                </div>
              );
            }

            return null;
          };

          if (currentScreen === 'welcome') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-red-600 via-orange-500 to-yellow-500 flex items-center justify-center p-4">
                <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-lg w-full text-center relative overflow-hidden">
                  <div className="absolute inset-0 opacity-5">
                    <div className="absolute top-4 left-4 w-8 h-8 bg-red-500 rounded-full"></div>
                    <div className="absolute top-12 right-8 w-4 h-4 bg-orange-500 rounded-full"></div>
                    <div className="absolute bottom-8 left-12 w-6 h-6 bg-yellow-500 rounded-full"></div>
                    <div className="absolute bottom-4 right-4 w-8 h-8 bg-red-500 rounded-full"></div>
                  </div>
                  
                  <div className="relative z-10">
                    <div className="mb-8">
                      <div className="w-24 h-24 bg-gradient-to-br from-red-500 via-orange-500 to-yellow-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg">
                        <div className="text-4xl font-bold text-white">F</div>
                      </div>
                      
                      <h1 className="text-4xl font-bold bg-gradient-to-r from-red-600 to-orange-600 bg-clip-text text-transparent mb-3">
                        FrustrationsFri
                      </h1>
                      <p className="text-lg text-gray-600 mb-2">Slip dine frustrationer l√∏s</p>
                      <p className="text-sm text-gray-500">Sikker digital udladning for alle typer frustrationer</p>
                    </div>
                    
                    <div className="mb-8 text-left bg-gray-50 rounded-xl p-6">
                      <h3 className="font-bold text-gray-800 mb-4 text-center">üéØ Hvordan det virker:</h3>
                      <div className="space-y-3">
                        <div className="flex items-start gap-3">
                          <div className="w-8 h-8 bg-gradient-to-r from-red-500 to-orange-500 rounded-full flex items-center justify-center text-white font-bold text-sm">1</div>
                          <div>
                            <p className="font-medium text-gray-800">V√¶lg din frustration</p>
                            <p className="text-sm text-gray-600">Chef, partner, trafikanter - 12 scenarier</p>
                          </div>
                        </div>
                        <div className="flex items-start gap-3">
                          <div className="w-8 h-8 bg-gradient-to-r from-orange-500 to-yellow-500 rounded-full flex items-center justify-center text-white font-bold text-sm">2</div>
                          <div>
                            <p className="font-medium text-gray-800">V√¶lg intensitet</p>
                            <p className="text-sm text-gray-600">Mild, medium eller intens udfordring</p>
                          </div>
                        </div>
                        <div className="flex items-start gap-3">
                          <div className="w-8 h-8 bg-gradient-to-r from-yellow-500 to-red-500 rounded-full flex items-center justify-center text-white font-bold text-sm">3</div>
                          <div>
                            <p className="font-medium text-gray-800">F√• det ud</p>
                            <p className="text-sm text-gray-600">Sikker samtale med AI der udfordrer dig</p>
                          </div>
                        </div>
                        <div className="flex items-start gap-3">
                          <div className="w-8 h-8 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center text-white font-bold text-sm">4</div>
                          <div>
                            <p className="font-medium text-gray-800">Find ro & afsp√¶nding</p>
                            <p className="text-sm text-gray-600">Afsp√¶ndings√∏velser og refleksion - n√•r som helst</p>
                          </div>
                        </div>
                      </div>
                    </div>

                    {('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) ? (
                      <div className="bg-green-50 border-2 border-green-200 rounded-xl p-4 mb-6">
                        <div className="flex items-center justify-center gap-2 text-green-700 mb-2">
                          <Mic className="w-5 h-5" />
                          <span className="font-semibold">Stemme-support aktiveret</span>
                        </div>
                        <p className="text-sm text-green-600">
                          Du kan tale direkte til appen for en mere naturlig oplevelse
                        </p>
                      </div>
                    ) : (
                      <div className="bg-amber-50 border-2 border-amber-200 rounded-xl p-4 mb-6">
                        <div className="flex items-center justify-center gap-2 text-amber-700 mb-2">
                          <MessageCircle className="w-5 h-5" />
                          <span className="font-semibold">Tekst-chat tilg√¶ngelig</span>
                        </div>
                        <p className="text-sm text-amber-600">
                          Din browser underst√∏tter ikke tale-funktioner. Pr√∏v Chrome eller Safari for bedste oplevelse.
                        </p>
                      </div>
                    )}

                    <button
                      onClick={() => setCurrentScreen('scenarios')}
                      className="bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500 text-white px-10 py-4 rounded-xl font-bold text-lg hover:shadow-lg hover:scale-105 transition-all duration-200 w-full mb-4"
                    >
                      üöÄ Start frustration session
                    </button>

                    <button
                      onClick={() => setCurrentScreen('find-ro')}
                      className="bg-gradient-to-r from-green-500 via-blue-500 to-purple-500 text-white px-10 py-4 rounded-xl font-bold text-lg hover:shadow-lg hover:scale-105 transition-all duration-200 w-full mb-4"
                    >
                      üßò‚Äç‚ôÄÔ∏è Find ro & afsp√¶nding
                    </button>

                    {sessionHistory.length > 0 && (
                      <button
                        onClick={() => setShowHistory(!showHistory)}
                        className="w-full text-gray-600 hover:text-gray-800 transition-colors font-medium"
                      >
                        üìä Mine {sessionHistory.length} tidligere sessioner
                      </button>
                    )}

                    {showHistory && sessionHistory.length > 0 && (
                      <div className="mt-6 bg-gray-50 rounded-xl p-4 max-h-60 overflow-y-auto">
                        <h4 className="font-bold text-gray-800 mb-4 text-center">üìà Din aktivitet</h4>
                        <div className="space-y-2">
                          {sessionHistory.slice(0, 5).map(session => (
                            <div key={session.id} className="bg-white rounded-lg p-3 text-left shadow-sm">
                              <div className="flex items-center gap-2 mb-1">
                                <span className="text-lg">{session.scenarioEmoji}</span>
                                <span className="font-medium text-sm text-gray-800">{session.scenario}</span>
                                <span className="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">
                                  {session.intensity}
                                </span>
                              </div>
                              <div className="flex justify-between items-center text-xs text-gray-500">
                                <span>{session.date}</span>
                                <span>{session.messageCount} beskeder</span>
                                {session.feedback && <span>‚≠ê {session.feedback}/5</span>}
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    <div className="mt-8 pt-6 border-t border-gray-200">
                      <p className="text-xs text-gray-400">
                        üéâ Live p√• GitHub Pages! üöÄ Nu virker mikrofon og stemme-funktioner
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          if (currentScreen === 'find-ro') {
            return <FindRoComponent />;
          }

          if (currentScreen === 'scenarios') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-teal-600 p-4">
                <div className="max-w-4xl mx-auto">
                  <div className="text-center mb-8">
                    <h2 className="text-3xl font-bold text-white mb-4">Hvem er du frustreret p√•?</h2>
                    <p className="text-purple-100 mb-2">V√¶lg det scenario der passer bedst til din situation</p>
                    <p className="text-purple-200 text-sm">
                      üéØ {scenarios.length} forskellige frustrationstyper tilg√¶ngelige
                    </p>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    {scenarios.map(scenario => (
                      <div
                        key={scenario.id}
                        onClick={() => {
                          setSelectedScenario(scenario);
                          setCurrentScreen('intensity');
                        }}
                        className="bg-white rounded-xl p-4 cursor-pointer hover:transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl"
                      >
                        <div className={`w-12 h-12 ${scenario.color} rounded-full flex items-center justify-center mx-auto mb-3`}>
                          <span className="text-2xl">{scenario.emoji}</span>
                        </div>
                        <h3 className="text-lg font-bold text-gray-800 mb-1 text-center">{scenario.title}</h3>
                        <p className="text-gray-600 text-center text-xs leading-tight">{scenario.description}</p>
                        
                        {voiceEnabled && (
                          <div className="text-center mt-2">
                            <span className="inline-flex items-center gap-1 text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">
                              <Volume2 className="w-3 h-3" />
                              {scenario.voice === 'male' ? 'Mand' : 'Kvinde'}
                            </span>
                          </div>
                        )}
                      </div>
                    ))}
                  </div>

                  <div className="text-center mt-8">
                    <button
                      onClick={() => setCurrentScreen('welcome')}
                      className="text-white hover:text-purple-200 transition-colors"
                    >
                      ‚Üê Tilbage til start
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          if (currentScreen === 'intensity') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-teal-600 p-4">
                <div className="max-w-2xl mx-auto">
                  <div className="text-center mb-8">
                    <div className="flex items-center justify-center gap-3 mb-4">
                      <div className={`w-12 h-12 ${selectedScenario?.color} rounded-full flex items-center justify-center`}>
                        <span className="text-2xl">{selectedScenario?.emoji}</span>
                      </div>
                      <h2 className="text-3xl font-bold text-white">{selectedScenario?.title}</h2>
                    </div>
                    <p className="text-purple-100 mb-4">Hvor intens skal samtalen v√¶re?</p>
                    <p className="text-purple-200 text-sm">V√¶lg hvor provokerende AI'en skal v√¶re</p>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    {intensityLevels.map(intensity => (
                      <div
                        key={intensity.id}
                        onClick={() => setSelectedIntensity(intensity.id)}
                        className={`bg-white rounded-xl p-6 cursor-pointer transition-all duration-200 ${
                          selectedIntensity === intensity.id 
                            ? 'ring-4 ring-yellow-400 transform scale-105 shadow-2xl' 
                            : 'hover:transform hover:scale-105 shadow-lg hover:shadow-xl'
                        }`}
                      >
                        <div className={`w-16 h-16 ${intensity.color} rounded-full flex items-center justify-center mx-auto mb-4`}>
                          <span className="text-3xl">{intensity.emoji}</span>
                        </div>
                        <h3 className="text-xl font-bold text-gray-800 mb-2 text-center">{intensity.title}</h3>
                        <p className="text-gray-600 text-center text-sm">{intensity.description}</p>
                      </div>
                    ))}
                  </div>

                  <div className="text-center">
                    <button
                      onClick={() => {
                        setCurrentScreen('chat');
                        
                        const welcomeMessages = {
                          chef: "Hvad vil du? Jeg har travlt og mange vigtige ting at tage mig af.",
                          partner: "Hvad er der nu? Jeg har lige haft en lang dag og gider ikke mere drama.",
                          ex: "N√•, hvad vil du? Jeg troede vi var f√¶rdige med hinanden.",
                          for√¶lder: "Nu m√• du lige h√∏re efter n√•r jeg taler til dig. Hvad er det der er s√• vigtigt?",
                          b√∏rn: "Hvad er det nu? Jeg gider ikke h√∏re p√• dine klager igen.",
                          kollega: "Hej! Jeg har forresten lige f√•et ros af chefen for mit arbejde. Hvad ville du?",
                          venner: "Hey! Jeg har det faktisk rigtig godt for tiden. Hvad er der?",
                          naboer: "N√•, hvad vil du nu? Jeg h√•ber ikke det er for at klage igen.",
                          trafik: "Hvad fanden laver du? Kan du ikke k√∏re ordenligt?",
                          kundeservice: "Hej og tak for din henvendelse. Hvad kan jeg hj√¶lpe med i dag?",
                          politik: "Vi arbejder h√•rdt for befolkningen hver dag. Hvad er dit sp√∏rgsm√•l?",
                          sociale_medier: "N√•, endnu en der skal klage over noget online. Hvad er det denne gang?"
                        };
                        
                        const welcomeMessage = {
                          id: 1,
                          text: welcomeMessages[selectedScenario.id] || "Hvad vil du?",
                          sender: 'ai',
                          timestamp: new Date()
                        };
                        setMessages([welcomeMessage]);
                        
                        setTimeout(() => {
                          if (voiceEnabled) {
                            speakMessage(welcomeMessage.text, selectedScenario.voice);
                          }
                        }, 1000);
                      }}
                      className="bg-gradient-to-r from-orange-500 to-red-500 text-white px-8 py-3 rounded-lg font-semibold hover:from-orange-600 hover:to-red-600 transition-all duration-200 transform hover:scale-105 mb-4"
                    >
                      Start samtale üöÄ
                    </button>

                    <div className="space-y-2">
                      <button
                        onClick={() => setCurrentScreen('scenarios')}
                        className="block mx-auto text-white hover:text-purple-200 transition-colors text-sm"
                      >
                        ‚Üê Tilbage til scenarier
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          if (currentScreen === 'chat') {
            return (
              <div className="min-h-screen bg-gray-100 flex flex-col">
                {/* Header */}
                <div className="bg-white shadow-sm border-b p-3 md:p-4">
                  <div className="max-w-4xl mx-auto flex items-center justify-between">
                    <div className="flex items-center gap-2 md:gap-3">
                      <div className={`w-8 h-8 md:w-10 md:h-10 ${selectedScenario?.color} rounded-full flex items-center justify-center`}>
                        <span className="text-lg md:text-xl">{selectedScenario?.emoji}</span>
                      </div>
                      <div>
                        <h2 className="font-bold text-gray-800 text-sm md:text-base">{selectedScenario?.title}</h2>
                        <p className="text-xs md:text-sm text-gray-600">
                          {sessionPhase === 'provokation' ? `F√• det ud üí¢ (${selectedIntensity})` : 
                           sessionPhase === 'refleksion' ? 'Reflekter ü§î' : 'Afslut üåÖ'}
                        </p>
                      </div>
                    </div>
                    <div className="flex items-center gap-2 md:gap-3">
                      <button
                        onClick={toggleVoice}
                        className={`p-1 md:p-2 rounded-lg transition-colors ${
                          voiceEnabled ? 'bg-green-100 text-green-600' : 'bg-gray-100 text-gray-400'
                        }`}
                        title={voiceEnabled ? 'Lyd til' : 'Lyd fra'}
                      >
                        {voiceEnabled ? <Volume2 className="w-4 h-4 md:w-5 md:h-5" /> : <VolumeX className="w-4 h-4 md:w-5 md:h-5" />}
                      </button>
                      
                      <button
                        onClick={startNewSession}
                        className="flex items-center gap-1 md:gap-2 text-gray-600 hover:text-gray-800 transition-colors text-xs md:text-sm"
                      >
                        <RotateCcw className="w-3 h-3 md:w-4 md:h-4" />
                        <span className="hidden md:inline">Ny session</span>
                      </button>
                    </div>
                  </div>
                </div>

                {/* Messages */}
                <div className="flex-1 overflow-y-auto p-3 md:p-4">
                  <div className="max-w-4xl mx-auto space-y-3 md:space-y-4">
                    {messages.map(message => (
                      <div
                        key={message.id}
                        className={`flex ${message.sender === 'user' ? 'justify-end' : 'justify-start'}`}
                      >
                        <div
                          className={`max-w-xs md:max-w-md lg:max-w-lg px-3 md:px-4 py-2 rounded-lg text-sm md:text-base ${
                            message.sender === 'user'
                              ? 'bg-blue-500 text-white rounded-br-none'
                              : message.isTransition
                              ? 'bg-green-100 text-green-800 border border-green-200 rounded-bl-none'
                              : 'bg-white text-gray-800 shadow-sm rounded-bl-none'
                          }`}
                        >
                          <p className={`${message.isTransition ? 'font-medium' : ''}`}>{message.text}</p>
                          <p className={`text-xs mt-1 ${
                            message.sender === 'user' ? 'text-blue-100' : 'text-gray-500'
                          }`}>
                            {message.timestamp.toLocaleTimeString('da-DK', { 
                              hour: '2-digit', 
                              minute: '2-digit' 
                            })}
                          </p>
                        </div>
                      </div>
                    ))}
                    
                    {isLoading && (
                      <div className="flex justify-start">
                        <div className="bg-white text-gray-800 shadow-sm rounded-lg rounded-bl-none px-3 md:px-4 py-2">
                          <div className="flex space-x-1">
                            <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                            <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{animationDelay: '0.1s'}}></div>
                            <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{animationDelay: '0.2s'}}></div>
                          </div>
                        </div>
                      </div>
                    )}
                    <div ref={messagesEndRef} />
                  </div>
                </div>

                {/* Input */}
                {sessionPhase !== 'afslutning' ? (
                  <div className="bg-white border-t p-3 md:p-4">
                    <div className="max-w-4xl mx-auto">
                      {isListening && (
                        <div className="mb-3 text-center">
                          <div className="inline-flex items-center gap-2 bg-red-100 text-red-700 px-3 md:px-4 py-2 rounded-lg text-sm">
                            <div className="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                            Lytter... Tal nu
                          </div>
                        </div>
                      )}
                      
                      {isSpeaking && (
                        <div className="mb-3 text-center">
                          <div className="inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-3 md:px-4 py-2 rounded-lg text-sm">
                            <Volume2 className="w-4 h-4 animate-pulse" />
                            Taler...
                          </div>
                        </div>
                      )}

                      <div className="flex gap-2">
                        <textarea
                          value={inputMessage}
                          onChange={(e) => setInputMessage(e.target.value)}
                          onKeyPress={handleKeyPress}
                          placeholder={isListening ? "Lytter..." : 
                            sessionPhase === 'provokation' ? 
                            "Fort√¶l om din frustration..." : 
                            "Hvordan har du det nu?"}
                          className="flex-1 border border-gray-300 rounded-lg px-3 md:px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none text-sm md:text-base"
                          rows="2"
                          disabled={isLoading || isListening}
                        />
                        
                        {recognitionRef.current && (
                          <button
                            onClick={isListening ? stopListening : startListening}
                            disabled={isLoading || isSpeaking}
                            className={`px-3 md:px-4 py-2 rounded-lg transition-colors flex items-center gap-2 text-sm md:text-base ${
                              isListening 
                                ? 'bg-red-500 text-white hover:bg-red-600' 
                                : 'bg-gray-500 text-white hover:bg-gray-600'
                            } disabled:bg-gray-300 disabled:cursor-not-allowed`}
                            title={isListening ? 'Stop optagelse' : 'Start optagelse'}
                          >
                            {isListening ? <MicOff className="w-4 h-4" /> : <Mic className="w-4 h-4" />}
                          </button>
                        )}
                        
                        <button
                          onClick={sendMessage}
                          disabled={!inputMessage.trim() || isLoading || isListening}
                          className="bg-blue-500 text-white px-4 md:px-6 py-2 rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center gap-2 text-sm md:text-base"
                        >
                          <Send className="w-4 h-4" />
                          <span className="hidden md:inline">Send</span>
                        </button>
                      </div>
                      
                      {recognitionRef.current && (
                        <div className="mt-2 text-center">
                          <p className="text-xs text-gray-500">
                            üí° Tip: Brug mikrofonen üé§ for en mere naturlig samtale-oplevelse
                          </p>
                        </div>
                      )}
                    </div>
                  </div>
                ) : (
                  <div className="bg-green-50 border-t p-6">
                    <div className="max-w-4xl mx-auto text-center">
                      <div className="mb-6">
                        <Heart className="w-12 h-12 text-green-500 mx-auto mb-2" />
                        <h3 className="text-xl font-bold text-green-800 mb-2">Session afsluttet</h3>
                        <p className="text-green-700">Godt g√•et! Du har f√•et udtrykt dine f√∏lelser og reflekteret over dem.</p>
                      </div>
                      
                      <div className="bg-white rounded-lg p-4 mb-6 text-left max-w-md mx-auto">
                        <h4 className="font-semibold text-gray-800 mb-2">üí´ Afsp√¶ndings√∏velse</h4>
                        <p className="text-sm text-gray-600 mb-2">Tag 3 dybe vejrtr√¶kninger:</p>
                        <ol className="text-sm text-gray-600 space-y-1">
                          <li>1. Ind√•nd i 4 sekunder</li>
                          <li>2. Hold vejret i 4 sekunder</li>
                          <li>3. Ud√•nd langsomt i 6 sekunder</li>
                        </ol>
                      </div>

                      {!sessionFeedback && (
                        <div className="bg-blue-50 rounded-lg p-4 mb-6 max-w-md mx-auto">
                          <h4 className="font-semibold text-gray-800 mb-3">Hvor godt hjalp sessionen dig?</h4>
                          <div className="flex justify-center gap-2">
                            {[1, 2, 3, 4, 5].map(rating => (
                              <button
                                key={rating}
                                onClick={() => {
                                  setSessionFeedback(rating);
                                  saveSessionToHistory(selectedScenario, selectedIntensity, messageCount, rating);
                                }}
                                className="text-2xl hover:scale-110 transition-transform"
                              >
                                ‚≠ê
                              </button>
                            ))}
                          </div>
                          <p className="text-xs text-gray-600 mt-2">1 = Ikke hj√¶lpsomt, 5 = Meget hj√¶lpsomt</p>
                        </div>
                      )}

                      {sessionFeedback && (
                        <div className="bg-blue-50 rounded-lg p-4 mb-6 max-w-md mx-auto">
                          <p className="text-sm text-gray-700">
                            Tak for din feedback! Du gav {sessionFeedback}/5 stjerner ‚≠ê
                          </p>
                        </div>
                      )}

                      <div className="space-y-3">
                        <button
                          onClick={() => setCurrentScreen('find-ro')}
                          className="bg-gradient-to-r from-green-500 via-blue-500 to-purple-500 text-white px-8 py-3 rounded-lg hover:shadow-lg transition-all duration-200 font-semibold mr-3"
                        >
                          üßò‚Äç‚ôÄÔ∏è Find Ro & Afsp√¶nding
                        </button>
                        
                        <button
                          onClick={startNewSession}
                          className="bg-blue-500 text-white px-8 py-3 rounded-lg hover:bg-blue-600 transition-colors font-semibold"
                        >
                          Start Ny Session
                        </button>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            );
          }

          return null;
        };

        // Render the app
        ReactDOM.render(<FrustrationApp />, document.getElementById('root'));
    </script>
</body>
</html>
